@page "/"
@using System.Text.Json.Serialization
@using BlazorOIDCFlow.Contracts
@using Microsoft.Extensions.Localization
@inject HttpClient Http
@inject IRageApiService RageApiService
@inject IStringLocalizer<App> Localizer

<CascadingValue Value="Model">
    <OIDCContainer />
</CascadingValue>

@code {
    public OIDCModel Model { get; set; } = new OIDCModel();

    protected override async Task OnInitializedAsync()
    {
        var wrappedResponse = await RageApiService.GetManifestAsync();
        var manifest = wrappedResponse?.Response;
        Model.Manifest = manifest;

        foreach (var socialIdp in Model.Manifest.SocialIdps)
        {
            var socialName = Localizer[socialIdp.Slug];
            socialIdp.Name = socialName;
        }
       
    }
}
